<!DOCTYPE html>
<html lang="fr" 
      xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">

<head>
    <title>Tableau de bord - BeeTrack</title>
</head>

<body>
    <div layout:fragment="content">
        <!-- Container principal -->
        <div class="dashboard-wrapper">
            
            <!-- En-tête du dashboard -->
            <div class="dashboard-hero">
                <div class="hero-content">
                    <div class="hero-text">
                        <h1 class="hero-title">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                                <polyline points="9,22 9,12 15,12 15,22"/>
                            </svg>
                            Tableau de bord
                        </h1>
                        <p class="hero-subtitle">
                            Bonjour <span th:text="${#authentication != null ? #authentication.name : 'Apiculteur'}">Apiculteur</span>, 
                            voici l'état de vos ruches
                        </p>
                    </div>
                    <div class="hero-actions">
                        <button class="btn btn-light" onclick="location.reload()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23,4 23,10 17,10"/>
                                <polyline points="1,20 1,14 7,14"/>
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64l1.27 1.27m4.27 12.22l1.27 1.27A9 9 0 0 0 20.49 15"/>
                            </svg>
                            Actualiser
                        </button>
                        <a href="/ruches/nouvelle" th:href="@{/ruches/nouvelle}" class="btn btn-primary">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Nouvelle ruche
                        </a>
                    </div>
                </div>
            </div>

            <!-- Section des statistiques -->
            <div class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card stat-primary">
                        <div class="stat-content">
                            <div class="stat-main">
                                <div class="stat-number" th:text="${totalRuches ?: 0}">0</div>
                                <div class="stat-label">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polygon points="12,2 2,7 12,12 22,7 12,2"/>
                                        <polyline points="2,17 12,22 22,17"/>
                                        <polyline points="2,12 12,17 22,12"/>
                                    </svg>
                                    Ruches totales
                                </div>
                            </div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polygon points="12,2 2,7 12,12 22,7 12,2"/>
                                    <polyline points="2,17 12,22 22,17"/>
                                    <polyline points="2,12 12,17 22,12"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card stat-success">
                        <div class="stat-content">
                            <div class="stat-main">
                                <div class="stat-number" th:text="${totalRuchers ?: 0}">0</div>
                                <div class="stat-label">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                        <circle cx="12" cy="10" r="3"/>
                                    </svg>
                                    Ruchers actifs
                                </div>
                            </div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                    <circle cx="12" cy="10" r="3"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card stat-warning">
                        <div class="stat-content">
                            <div class="stat-main">
                                <div class="stat-number" th:text="${alertesActives ?: 0}">0</div>
                                <div class="stat-label">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/>
                                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                    Alertes actives
                                </div>
                            </div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                    <line x1="12" y1="9" x2="12" y2="13"/>
                                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card stat-info">
                        <div class="stat-content">
                            <div class="stat-main">
                                <div class="stat-number" th:text="${temperatureMoyenne != null ? temperatureMoyenne + '°C' : '24.2°C'}">24.2°C</div>
                                <div class="stat-label">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/>
                                    </svg>
                                    Temp. moyenne
                                </div>
                            </div>
                            <div class="stat-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section des actions rapides -->
            <div class="actions-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"/>
                        </svg>
                        Actions rapides
                    </h2>
                    <p class="section-description">Accédez rapidement aux fonctionnalités principales</p>
                </div>
                
                <div class="actions-grid">
                    <a href="/ruches/nouvelle" th:href="@{/ruches/nouvelle}" class="action-card">
                        <div class="action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h3 class="action-title">Ajouter une ruche</h3>
                            <p class="action-description">Enregistrer une nouvelle ruche dans votre système</p>
                        </div>
                    </a>
                    
                    <a href="/ruchers" th:href="@{/ruchers}" class="action-card">
                        <div class="action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h3 class="action-title">Gérer les ruchers</h3>
                            <p class="action-description">Organiser vos emplacements et ruchers</p>
                        </div>
                    </a>
                    
                    <a href="/alertes" th:href="@{/alertes}" class="action-card">
                        <div class="action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h3 class="action-title">Voir les alertes</h3>
                            <p class="action-description">Surveiller les notifications importantes</p>
                        </div>
                    </a>
                    
                    <a href="/statistiques" th:href="@{/statistiques}" class="action-card">
                        <div class="action-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="20" x2="12" y2="10"/>
                                <line x1="18" y1="20" x2="18" y2="4"/>
                                <line x1="6" y1="20" x2="6" y2="16"/>
                            </svg>
                        </div>
                        <div class="action-content">
                            <h3 class="action-title">Statistiques</h3>
                            <p class="action-description">Analyser les performances de vos ruches</p>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Section du contenu principal -->
            <div class="content-section">
                <div class="content-grid">
                    <!-- Ruches récentes -->
                    <div class="content-card">
                        <div class="card-header">
                            <div class="card-title-group">
                                <h3 class="card-title">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polygon points="12,2 2,7 12,12 22,7 12,2"/>
                                        <polyline points="2,17 12,22 22,17"/>
                                        <polyline points="2,12 12,17 22,12"/>
                                    </svg>
                                    Ruches récentes
                                </h3>
                                <span class="card-subtitle">Dernières mises à jour</span>
                            </div>
                            <a href="/ruches" th:href="@{/ruches}" class="btn btn-sm btn-outline">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M7 17L17 7"/>
                                    <path d="M7 7h10v10"/>
                                </svg>
                                Voir tout
                            </a>
                        </div>
                        
                        <div class="card-body">
                            <div th:if="${ruches != null && !#lists.isEmpty(ruches)}" class="ruches-list">
                                <div th:each="ruche : ${#lists.size(ruches) > 5 ? ruches.subList(0, 5) : ruches}" 
                                     class="ruche-item">
                                    <div class="ruche-info">
                                        <div class="ruche-avatar">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <polygon points="12,2 2,7 12,12 22,7 12,2"/>
                                                <polyline points="2,17 12,22 22,17"/>
                                                <polyline points="2,12 12,17 22,12"/>
                                            </svg>
                                        </div>
                                        <div class="ruche-details">
                                            <div class="ruche-name" th:text="${ruche.nom ?: ruche.id}">Ruche Alpha</div>
                                            <div class="ruche-location" th:text="${ruche.rucherNom ?: 'Emplacement non défini'}">Rucher Principal</div>
                                        </div>
                                    </div>
                                    <div class="ruche-status">
                                        <div class="ruche-temp" th:text="${ruche.temperature != null ? ruche.temperature + '°C' : 'N/A'}">24.5°C</div>
                                        <div th:if="${ruche.actif}" class="status-badge status-active">Actif</div>
                                        <div th:unless="${ruche.actif}" class="status-badge status-inactive">Inactif</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div th:if="${ruches == null || #lists.isEmpty(ruches)}" class="empty-state">
                                <div class="empty-icon">
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polygon points="12,2 2,7 12,12 22,7 12,2"/>
                                        <polyline points="2,17 12,22 22,17"/>
                                        <polyline points="2,12 12,17 22,12"/>
                                    </svg>
                                </div>
                                <h4 class="empty-title">Aucune ruche</h4>
                                <p class="empty-description">Ajoutez votre première ruche pour commencer</p>
                                <a href="/ruches/nouvelle" th:href="@{/ruches/nouvelle}" class="btn btn-primary">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="12" y1="5" x2="12" y2="19"/>
                                        <line x1="5" y1="12" x2="19" y2="12"/>
                                    </svg>
                                    Ajouter une ruche
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Activités récentes -->
                    <div class="content-card">
                        <div class="card-header">
                            <div class="card-title-group">
                                <h3 class="card-title">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                                    </svg>
                                    Activités récentes
                                </h3>
                                <span class="card-subtitle">Derniers événements</span>
                            </div>
                        </div>
                        
                        <div class="card-body">
                            <div class="activity-feed">
                                <div class="activity-item">
                                    <div class="activity-avatar activity-success">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="20,6 9,17 4,12"/>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Ruche Alpha mise à jour</div>
                                        <div class="activity-description">Température normale: 24.5°C</div>
                                        <div class="activity-time">Il y a 5 minutes</div>
                                    </div>
                                </div>
                                
                                <div class="activity-item">
                                    <div class="activity-avatar activity-warning">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                            <line x1="12" y1="9" x2="12" y2="13"/>
                                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Alerte détectée</div>
                                        <div class="activity-description">Humidité élevée sur Ruche Beta</div>
                                        <div class="activity-time">Il y a 15 minutes</div>
                                    </div>
                                </div>
                                
                                <div class="activity-item">
                                    <div class="activity-avatar activity-info">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="5" x2="12" y2="19"/>
                                            <line x1="5" y1="12" x2="19" y2="12"/>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Nouvelle ruche ajoutée</div>
                                        <div class="activity-description">Ruche Gamma enregistrée</div>
                                        <div class="activity-time">Il y a 1 heure</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>